<!doctype html>
<head>
    <title>CodeMirror: HTML5 preview</title>
    <meta charset="utf-8"/>
    <!--codemirror-->
    <link rel=stylesheet href=CodeMirror/doc/docs.css>
    <link rel=stylesheet href=CodeMirror/theme/tomorrow-night-eighties.css>
    <link rel=stylesheet href=CodeMirror/lib/codemirror.css>
    <link rel=stylesheet href=CodeMirror/addon/display/fullscreen.css>
    <link rel=stylesheet href=CodeMirror/addon/lint/lint.css>
    <link rel=stylesheet href=CodeMirror/addon/fold/foldgutter.css>
    <script src=CodeMirror/lib/codemirror.js></script>
    <script src=CodeMirror/mode/xml/xml.js></script>
    <script src=CodeMirror/mode/javascript/javascript.js></script>
    <script src=CodeMirror/mode/css/css.js></script>
    <script src=CodeMirror/mode/htmlmixed/htmlmixed.js></script>
    <!--<script src="CodeMirror/addon/selection/active-line.js"></script>-->
    <script src="CodeMirror/addon/display/fullscreen.js"></script>
    <script src="CodeMirror/addon/edit/closebrackets.js"></script>
    <script src="CodeMirror/addon/edit/closetag.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jshint/r07/jshint.js"></script>
    <script src="https://rawgithub.com/stubbornella/csslint/master/release/csslint.js"></script>
    <script src="CodeMirror/addon/lint/lint.js"></script>
    <script src="CodeMirror/addon/lint/javascript-lint.js"></script>
    <script src="CodeMirror/addon/lint/css-lint.js"></script>
    <script src="CodeMirror/addon/fold/foldcode.js"></script>
    <script src="CodeMirror/addon/fold/foldgutter.js"></script>
    <script src="CodeMirror/addon/fold/brace-fold.js"></script>
    <script src="CodeMirror/addon/fold/xml-fold.js"></script>
    <script src="CodeMirror/addon/fold/comment-fold.js"></script>
    <!--bootstrap-->
    <link href='css/bootstrap.min.css' rel='stylesheet' type='text/css'/>
    <link href='css/bootstrap-theme.min.css' rel='stylesheet' type='text/css'/>

    <style type=text/css>
        body {
            background: #1d1f20;
        }

        .CodeMirror {
            float: left;
            width: 800px;
            height: 650px;
            border: 0px solid black;

            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;
            color: black;
            font-size: 14px;
            line-height: 19px;
            direction: ltr;
        }

            /*cursor color*/
        .cm-s-tomorrow-night-eighties .CodeMirror-cursor {
            border-left: 2px solid #eeeeee !important;
        }

            /*editor color*/
        .cm-s-tomorrow-night-eighties.CodeMirror {
            background: #232c31;
            color: #F7F0F0;
        }

        .cm-s-tomorrow-night-eighties .CodeMirror-gutters {
            background: #232c31;
            color: #F7F0F0;
            border-right: 0px;
        }

            /*preview window*/
        iframe {
            /*width: 62.5%;*/
            float: left;
            height: 650px;
            /*background: #1d1f20;*/
            /*color: #ffffff;*/
            border: 1px solid #a21313;
        }

            /*code window*/
        article {
            padding: 0px;
            border-right: 0px;
            margin-left: 200px;
            min-width: 1404px;
        }

            /*left navbar*/
        #nav {
            text-align: center;
            right: 0;
            width: 200px;
            padding-right: 0px;
            overflow-y: auto;
        }

        .left-nav-width {
            width: 200px;
        }

        #nav ul a {
            color: #a21313;
            padding: 0 7px 1px 11px;
        }

            /*header bar*/
        .navbar {
            min-height: 45px;
            height: 45px;
            margin-bottom: 0px;
        }
    </style>
</head>
<body>
<div id=nav>
    <a class=active href="#">
        <h1>预览编辑器</h1>
    </a>

    <ul>
        <li><a href="#">首页</a>
        <li><a href="#">Github</a>
        <li><a href="#">手册</a>
    </ul>
    <h5 style="color:#A21313">
        <input type="file" id="fileInput" class="left-nav-width">
    </h5>
</div>

<article style="min-height: inherit">

    <div>
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane active in" id="code_page">
                <textarea class="tab-pane active in" id=code name=code>
<!doctype html>
<html>
<head>
    <meta charset=utf-8>
    <title>HTML5 canvas demo</title>
    <style>p {
        font-family: monospace;
        color: lime
    }</style>
</head>
<body>
<p>Canvas pane goes here:</p>
<canvas id=pane width=300 height=480></canvas>
<script>
    var canvas = document.getElementById('pane');
    var context = canvas.getContext('2d');

    context.fillStyle = 'rgba(250, 0, 0, 1)';
    context.fillRect(50, 50, 55, 50);

    context.fillStyle = 'rgba(0, 0, 250, 0.7)';
    context.fillRect(70, 70, 55, 50);
</script>
</body>
</html>
                </textarea>
            </div>
        </div>
    </div>

    <iframe id=preview-pad  scrolling="auto" frameborder="0" style="width: 600px"></iframe>
    <iframe id=preview-mobile  scrolling="auto" frameborder="0" style="width: 350px"></iframe>
    <iframe id=preview-desk  scrolling="auto" frameborder="0" style="width: 1050px"></iframe>

    <script name=code>
        var delay_mobile;
        var delay_pad;
        var delay_desk;
        // Initialize CodeMirror editor for html5.
        var editor = CodeMirror.fromTextArea(document.getElementById('code'), {
            //choose language
            mode: 'text/html',
//              mode: "javascript",
//              mode: "css",
            // add-on active-line line-number
//            styleActiveLine: true,
            lineNumbers: true,
            lineWrapping: true,
            //addd-on lint
//              gutters: ["CodeMirror-lint-markers"],
//              lint: true,
            // add-on auto-close-brackets
            autoCloseBrackets: true,
            // add-on auto-close-tags
            autoCloseTags: true,
            // add folding
            foldGutter: true,
            gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
            // add-on full-screen key:F11
            extraKeys: {
                "F11": function (cm) {
                    cm.setOption("fullScreen", !cm.getOption("fullScreen"));
                },
                "Esc": function (cm) {
                    if (cm.getOption("fullScreen")) cm.setOption("fullScreen", false);
                }
            }
        });
        // theme
        editor.setOption("theme", "tomorrow-night-eighties");
        // update preview window when code changed.
        editor.on("change", function () {
            clearTimeout(delay_mobile);
            clearTimeout(delay_pad);
            clearTimeout(delay_desk);
            delay_mobile = setTimeout(updatePreview('preview-mobile'), 300);
            delay_pad = setTimeout(updatePreview('preview-pad'), 300);
            delay_desk = setTimeout(updatePreview('preview-desk'), 300);
        });
        function updatePreview(preview_id) {
            var previewFrame = document.getElementById(preview_id);
            var preview = previewFrame.contentDocument || previewFrame.contentWindow.document;
            preview.open();
            preview.write(editor.getValue());
            preview.close();
        }
        delay_mobile = setTimeout(updatePreview('preview-mobile'), 300);
        delay_pad = setTimeout(updatePreview('preview-pad'), 300);
        delay_desk = setTimeout(updatePreview('preview-desk'), 300);

    </script>

    <script name=choose_file>
        window.onload = function () {
            var fileInput = document.getElementById('fileInput');
            fileInput.addEventListener('change', function (e) {
                var file = fileInput.files[0];
                var reader = new FileReader();
                reader.onload = function (e) {
                    editor.setValue(reader.result)
                }
                reader.readAsText(file);
            });
        }
    </script>

</article>

<script lang='javascript' src='lib/js/jquery/jquery-2.0.0.min.js'></script>
<script lang='javascript' src='lib/js/bootstrap/bootstrap.min.js'></script>

</body>
